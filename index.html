<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Kozybeats Lofi Player</title>
<style>
  /* Reset & basic */
  body, html {
    margin: 0; padding: 0; height: 100%;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #f3ede7;
    color: #222;
  }
  .app-container {
    position: relative;
    z-index: 10;
    background: rgba(243, 237, 231, 0.6);
    max-width: 900px;
    margin: 40px auto;
    padding: 30px;
    border-radius: 15px;
    box-shadow: 0 0 40px rgba(0,0,0,0.1);
  }
  header {
    display: flex;
    align-items: center;
    gap: 20px;
  }
  #cover {
    width: 120px;
    border-radius: 12px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
  }
  #project-title {
    font-size: 28px;
    font-weight: 700;
  }
  #now-playing {
    margin-top: 5px;
    font-weight: 500;
    color: #555;
  }
  /* Project buttons */
  #project-buttons {
    margin: 20px 0;
    display: flex;
    gap: 12px;
  }
  #project-buttons button {
    background: #d9ccc0;
    border: none;
    padding: 10px 18px;
    border-radius: 12px;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.3s ease;
  }
  #project-buttons button.active,
  #project-buttons button:hover {
    background: #a9917f;
    color: #fff;
  }
  /* Tracklist */
  #tracklist {
    max-height: 240px;
    overflow-y: auto;
    margin-bottom: 25px;
  }
  #tracklist button {
    width: 100%;
    padding: 10px 15px;
    background: #e8ded4;
    border: none;
    border-radius: 10px;
    margin-bottom: 10px;
    cursor: pointer;
    text-align: left;
    transition: background 0.3s ease;
  }
  #tracklist button.active,
  #tracklist button:hover {
    background: #a9917f;
    color: white;
  }
  /* Controls */
  #controls {
    display: flex;
    gap: 20px;
    align-items: center;
    justify-content: center;
    margin-top: 10px;
  }
  #controls button {
    background: #a9917f;
    border: none;
    border-radius: 50%;
    width: 44px;
    height: 44px;
    color: white;
    font-size: 20px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 0 8px rgba(169,145,127,0.8);
    transition: background 0.3s ease;
  }
  #controls button:hover {
    background: #806b5f;
  }
  /* Vinyl */
  #vinyl-container {
    margin-left: 25px;
  }
  #vinyl {
    width: 70px;
    user-select: none;
    transition: transform 0.1s linear;
  }
  /* Background video */
  #video-background {
    position: fixed;
    top: 0; left: 0;
    width: 100vw;
    height: 100vh;
    overflow: hidden;
    z-index: -5;
  }
  #video-background video {
    width: 100%;
    height: 100%;
    object-fit: cover;
    filter: brightness(0.5) blur(5px);
  }
  /* Project background overlay (blurred cover) */
  #project-bg-overlay {
    position: fixed;
    top: 0; left: 0;
    width: 100vw;
    height: 100vh;
    background-size: cover;
    background-position: center;
    filter: blur(30px) brightness(0.3);
    opacity: 0.7;
    z-index: -4;
    transition: background-image 0.5s ease;
  }
  /* Particle canvas */
  #particles {
    position: fixed;
    top: 0; left: 0;
    width: 100vw; height: 100vh;
    pointer-events: none;
    z-index: -3;
  }
</style>
</head>
<body>

<!-- Background video -->
<div id="video-background">
  <video autoplay muted loop playsinline>
    <source src="https://res.cloudinary.com/dvtt0ymce/video/upload/v1754228640/Cat_Mushroom_Animated_Digital_Wide_PC_Background_HD_Live_-_Etsy_Video_Video___Anime_wallpaper_Cute_wallpapers_Art_whcjmg.mp4" type="video/mp4" />
    Your browser does not support the video tag.
  </video>
</div>

<!-- Project cover blurred overlay -->
<div id="project-bg-overlay"></div>

<!-- Particle overlay -->
<canvas id="particles"></canvas>

<!-- Main app container -->
<div class="app-container">
  <header>
    <img id="cover" src="" alt="Project Cover" />
    <div>
      <div id="project-title">Project Title</div>
      <div id="now-playing">Now Playing: Kozybeats - Track Title</div>
    </div>
  </header>

  <div id="project-buttons">
    <button id="btn-pillowcore">Pillowcore Radio</button>
    <button id="btn-evening">Evening Static</button>
  </div>

  <div id="tracklist"></div>

  <div id="controls">
    <button id="prev-btn" title="Previous">&#9664;</button>
    <button id="play-pause-btn" title="Play/Pause">&#9654;</button>
    <button id="next-btn" title="Next">&#9654;&#9654;</button>
    <button id="shuffle-btn" title="Shuffle">&#128256;</button>
    <button id="repeat-track-btn" title="Repeat Track">&#128257;</button>
    <button id="repeat-project-btn" title="Repeat Project">&#128258;</button>

    <div id="vinyl-container">
      <img id="vinyl" src="https://res.cloudinary.com/dvtt0ymce/image/upload/v1754230124/Vinyl-PNG-Transparent-Image_lnmiyw.png" alt="Vinyl" />
    </div>
  </div>
</div>

<audio id="audioPlayer" preload="auto" controls></audio>

<script>
  const projects = {
    pillowcore: {
      title: "Pillowcore Radio",
      cover: "https://res.cloudinary.com/dvtt0ymce/image/upload/v1754227293/pillow_radio_xrdpqc.png",
      tracks: [
        { title: "Glow Sink", url: "https://res.cloudinary.com/dvtt0ymce/video/upload/v1754225847/Glow_Sink_sprxbn.mp3" },
        { title: "Paper Walls", url: "https://res.cloudinary.com/dvtt0ymce/video/upload/v1754225847/Paper_Walls_est5ei.mp3" },
        { title: "Lavender Shadows", url: "https://res.cloudinary.com/dvtt0ymce/video/upload/v1754225846/Lavender_Shadows_s3wayo.mp3" },
        { title: "Snooze Signal", url: "https://res.cloudinary.com/dvtt0ymce/video/upload/v1754225844/Snooze_Signal_vqjo70.mp3" },
        { title: "Dream Archive", url: "https://res.cloudinary.com/dvtt0ymce/video/upload/v1754225842/Dream_Archive_wrtdy3.mp3" },
        { title: "Warm Silence", url: "https://res.cloudinary.com/dvtt0ymce/video/upload/v1754225842/Warm_Silence_zxijcq.mp3" },
        { title: "Curtains Closed", url: "https://res.cloudinary.com/dvtt0ymce/video/upload/v1754225842/Curtains_Closed_nqpgtq.mp3" },
        { title: "Ceiling Fan Dreams", url: "https://res.cloudinary.com/dvtt0ymce/video/upload/v1754225842/Ceiling_Fan_Dreams_xqlsq7.mp3" },
        { title: "Whispers in Blue", url: "https://res.cloudinary.com/dvtt0ymce/video/upload/v1754225841/Whispers_in_Blue_tgitgu.mp3" },
        { title: "Rain on 4th Street", url: "https://res.cloudinary.com/dvtt0ymce/video/upload/v1754225841/Rain_on_4th_Street_vt5sb9.mp3" },
        { title: "Moonlit Linen", url: "https://res.cloudinary.com/dvtt0ymce/video/upload/v1754225841/Moonlit_Linen_nwjuzr.mp3" },
        { title: "Midnight Left on Read", url: "https://res.cloudinary.com/dvtt0ymce/video/upload/v1754225841/Midnight_Left_on_Read_vy5iqm.mp3" }
      ]
    },
    evening: {
      title: "Evening Static",
      cover: "https://res.cloudinary.com/dvtt0ymce/image/upload/v1754229102/056f89b5bdd7b2944636c4e480196abe_1_bhyub6.jpg",
      tracks: [
        { title: "Curtains Breathing Slow", url: "https://res.cloudinary.com/dvtt0ymce/video/upload/v1754229134/Curtains_Breathing_Slow_si8vdi.mp3" },
        { title: "Heard My Name in the Hiss", url: "https://res.cloudinary.com/dvtt0ymce/video/upload/v1754229134/Heard_My_Name_in_the_Hiss_yi1jfb.mp3" },
        { title: "Stayed Just Long Enough", url: "https://res.cloudinary.com/dvtt0ymce/video/upload/v1754229136/Stayed_Just_Long_Enough_wlkxsb.mp3" },
        { title: "Memories on the Window Glass", url: "https://res.cloudinary.com/dvtt0ymce/video/upload/v1754229137/Memories_on_the_Window_Glass_uw4vxm.mp3" },
        { title: "TV Snow in My Mind", url: "https://res.cloudinary.com/dvtt0ymce/video/upload/v1754229138/TV_Snow_in_My_Mind_oxtsqi.mp3" },
        { title: "Pages Left Open", url: "https://res.cloudinary.com/dvtt0ymce/video/upload/v1754229139/Pages_Left_Open_r4bxvz.mp3" },
        { title: "The Fan Still Spins", url: "https://res.cloudinary.com/dvtt0ymce/video/upload/v1754229139/The_Fan_Still_Spins_qba31z.mp3" },
        { title: "When the Floorboard Creaked", url: "https://res.cloudinary.com/dvtt0ymce/video/upload/v1754229142/When_the_Floorboard_Creaked_ljcd2m.mp3" },
        { title: "A Thread Pulled from the Moon", url: "https://res.cloudinary.com/dvtt0ymce/video/upload/v1754229143/A_Thread_Pulled_from_the_Moon_kqjhdq.mp3" },
        { title: "Between the Glow and the Silence", url: "https://res.cloudinary.com/dvtt0ymce/video/upload/v1754229143/Between_the_Glow_and_the_Silence_xv6mht.mp3" }
      ]
    }
  };

  const btnPillowcore = document.getElementById('btn-pillowcore');
  const btnEvening = document.getElementById('btn-evening');
  const coverEl = document.getElementById('cover');
  const projectTitleEl = document.getElementById('project-title');
  const nowPlayingEl = document.getElementById('now-playing');
  const tracklistEl = document.getElementById('tracklist');
  const audioPlayer = document.getElementById('audioPlayer');
  const playPauseBtn = document.getElementById('play-pause-btn');
  const nextBtn = document.getElementById('next-btn');
  const prevBtn = document.getElementById('prev-btn');
  const shuffleBtn = document.getElementById('shuffle-btn');
  const repeatTrackBtn = document.getElementById('repeat-track-btn');
  const repeatProjectBtn = document.getElementById('repeat-project-btn');
  const vinyl = document.getElementById('vinyl');
  const projectBgOverlay = document.getElementById('project-bg-overlay');

  let currentProject = 'pillowcore';
  let currentTrackIndex = 0;
  let isPlaying = false;
  let vinylSpinning = false;
  let vinylRotation = 0;

  // Particle canvas setup
  const canvas = document.getElementById('particles');
  const ctx = canvas.getContext('2d');
  const PARTICLE_COUNT = 70;
  let particles = [];

  // Resize canvas
  function resizeCanvas() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
  }
  window.addEventListener('resize', resizeCanvas);
  resizeCanvas();

  class Particle {
    constructor() {
      this.x = Math.random() * canvas.width;
      this.y = Math.random() * canvas.height;
      this.size = 1 + Math.random() * 2;
      this.speedX = (Math.random() - 0.5) * 0.15;
      this.speedY = (Math.random() - 0.5) * 0.15;
      this.alpha = 0.05 + Math.random() * 0.1;
    }
    update() {
      this.x += this.speedX;
      this.y += this.speedY;
      if (this.x > canvas.width) this.x = 0;
      if (this.x < 0) this.x = canvas.width;
      if (this.y > canvas.height) this.y = 0;
      if (this.y < 0) this.y = canvas.height;
    }
    draw() {
      ctx.beginPath();
      ctx.fillStyle = `rgba(255, 255, 255, ${this.alpha})`;
      ctx.shadowColor = 'rgba(255, 255, 255, 0.15)';
      ctx.shadowBlur = 3;
      ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
      ctx.fill();
    }
  }

  function initParticles() {
    particles = [];
    for (let i = 0; i < PARTICLE_COUNT; i++) {
      particles.push(new Particle());
    }
  }
  function animateParticles() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    particles.forEach(p => {
      p.update();
      p.draw();
    });
    requestAnimationFrame(animateParticles);
  }

  // Vinyl spin animation
  function animateVinyl() {
    if (vinylSpinning) {
      vinylRotation += 0.8;
      vinyl.style.transform = `rotate(${vinylRotation}deg)`;
      requestAnimationFrame(animateVinyl);
    }
  }
  function startVinylSpin() {
    if (!vinylSpinning) {
      vinylSpinning = true;
      animateVinyl();
    }
  }
  function stopVinylSpin() {
    vinylSpinning = false;
  }

  // Build tracklist UI for current project
  function buildTracklist() {
    tracklistEl.innerHTML = '';
    projects[currentProject].tracks.forEach((track, i) => {
      const btn = document.createElement('button');
      btn.textContent = track.title;
      btn.className = i === currentTrackIndex && isPlaying ? 'active' : '';
      btn.onclick = () => {
        playTrack(i);
      };
      tracklistEl.appendChild(btn);
    });
  }

  // Play track by index, from current project
  function playTrack(index) {
    currentTrackIndex = index;
    audioPlayer.src = projects[currentProject].tracks[currentTrackIndex].url;
    audioPlayer.play();
    isPlaying = true;
    updateUIPlaying();
    startVinylSpin();
  }

  // Update UI elements when playing/paused or track changes
  function updateUIPlaying() {
    projectTitleEl.textContent = projects[currentProject].title;
    nowPlayingEl.textContent = `Now Playing: Kozybeats - ${projects[currentProject].tracks[currentTrackIndex].title}`;

    coverEl.src = projects[currentProject].cover;
    projectBgOverlay.style.backgroundImage = `url(${projects[currentProject].cover})`;
    projectBgOverlay.style.opacity = 1;

    [...tracklistEl.children].forEach((btn, i) => {
      btn.classList.toggle('active', i === currentTrackIndex && isPlaying);
    });

    if (isPlaying) {
      playPauseBtn.innerHTML = '&#10074;&#10074;'; // Pause icon
      startVinylSpin();
    } else {
      playPauseBtn.innerHTML = '&#9654;'; // Play icon
      stopVinylSpin();
    }
  }

  // Switch project and update UI, load first track but don't auto-play
  function switchProject(projKey) {
    if (!projects[projKey]) return;
    currentProject = projKey;

    btnPillowcore.classList.toggle('active', projKey === 'pillowcore');
    btnEvening.classList.toggle('active', projKey === 'evening');

    buildTracklist();

    currentTrackIndex = 0;
    audioPlayer.src = projects[currentProject].tracks[currentTrackIndex].url;
    audioPlayer.load();
    isPlaying = false;
    updateUIPlaying();
  }

  // Play/pause toggle
  playPauseBtn.onclick = () => {
    if (isPlaying) {
      audioPlayer.pause();
    } else {
      audioPlayer.play();
    }
  };

  // Prev track
  prevBtn.onclick = () => {
    currentTrackIndex--;
    if (currentTrackIndex < 0) currentTrackIndex = projects[currentProject].tracks.length - 1;
    playTrack(currentTrackIndex);
  };

  // Next track
  nextBtn.onclick = () => {
    currentTrackIndex++;
    if (currentTrackIndex >= projects[currentProject].tracks.length) currentTrackIndex = 0;
    playTrack(currentTrackIndex);
  };

  // Shuffle toggle (basic)
  let shuffle = false;
  shuffleBtn.onclick = () => {
    shuffle = !shuffle;
    shuffleBtn.style.background = shuffle ? '#806b5f' : '#a9917f';
  };

  // Repeat track toggle
  let repeatTrack = false;
  repeatTrackBtn.onclick = () => {
    repeatTrack = !repeatTrack;
    repeatTrackBtn.style.background = repeatTrack ? '#806b5f' : '#a9917f';
  };

  // Repeat project toggle
  let repeatProject = false;
  repeatProjectBtn.onclick = () => {
    repeatProject = !repeatProject;
    repeatProjectBtn.style.background = repeatProject ? '#806b5f' : '#a9917f';
  };

  // On track end
  audioPlayer.addEventListener('ended', () => {
    if (repeatTrack) {
      audioPlayer.currentTime = 0;
      audioPlayer.play();
    } else if (shuffle) {
      currentTrackIndex = Math.floor(Math.random() * projects[currentProject].tracks.length);
      playTrack(currentTrackIndex);
    } else {
      currentTrackIndex++;
      if (currentTrackIndex >= projects[currentProject].tracks.length) {
        if (repeatProject) {
          currentTrackIndex = 0;
          playTrack(currentTrackIndex);
        } else {
          isPlaying = false;
          updateUIPlaying();
        }
      } else {
        playTrack(currentTrackIndex);
      }
    }
  });

  audioPlayer.addEventListener('play', () => {
    isPlaying = true;
    updateUIPlaying();
  });

  audioPlayer.addEventListener('pause', () => {
    isPlaying = false;
    updateUIPlaying();
  });

  // Project buttons events
  btnPillowcore.onclick = () => switchProject('pillowcore');
  btnEvening.onclick = () => switchProject('evening');

  // Initialize particles and UI
  initParticles();
  animateParticles();
  switchProject('pillowcore');
</script>

</body>
</html>

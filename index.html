<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Kozybeats | Lofi Player</title>
  <style>
    * {
      box-sizing: border-box;
    }
    body, html {
      margin: 0;
      padding: 0;
      height:  100%;
      overflow: hidden;
      font-family: 'Segoe UI', sans-serif;
      background: #111;
      color: #fff;
    }
    video.bg-video {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      object-fit: cover;
      filter: blur(10px) brightness(0.4);
      z-index: -3;
    }
    .overlay {
      position: absolute;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      pointer-events: none;
      z-index: -2;
      background-image: radial-gradient(white 1px, transparent 1px);
      background-size: 20px 20px;
      opacity: 0.05;
    }
    .container {
      display: flex;
      height: 100vh;
      width: 100%;
    }
    .sidebar, .tracklist {
      width: 20%;
      padding: 15px;
      background: rgba(0,0,0,0.3);
      overflow-y: auto;
    }
    .sidebar {
      border-right: 1px solid #444;
    }
    .tracklist {
      border-left: 1px solid #444;
    }
    .content {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      padding: 20px;
    }
    .cover-button img {
      width: 100%;
      border-radius: 12px;
      cursor: pointer;
      margin-bottom: 15px;
    }
    .track-button {
      background: rgba(255,255,255,0.1);
      border: none;
      color: #fff;
      padding: 12px;
      border-radius: 8px;
      text-align: left;
      cursor: pointer;
      width: 100%;
      margin-bottom: 10px;
    }
    .track-button:hover, .track-button.active {
      background: rgba(255,255,255,0.25);
    }
    .player-bar {
      display: flex;
      align-items: center;
      gap: 20px;
      padding: 20px;
      background: rgba(0,0,0,0.4);
      border-radius: 16px;
      width: 100%;
    }
    .vinyl-box {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      overflow: hidden;
      flex-shrink: 0;
    }
    .vinyl {
      width: 100%;
      height: 100%;
      object-fit: cover;
      animation: spin 5s linear infinite;
      border-radius: 50%;
    }
    @keyframes spin {
      0% {transform: rotate(0deg);}
      100% {transform: rotate(360deg);}
    }
    .track-info {
      flex-grow: 1;
    }
    .controls button {
      background: none;
      border: none;
      color: white;
      font-size: 20px;
      cursor: pointer;
      margin: 0 5px;
    }
    .spotify-btn {
      margin-left: 15px;
      background: #1DB954;
      border: none;
      padding: 8px 14px;
      border-radius: 6px;
      font-weight: bold;
      color: white;
      text-decoration: none;
    }
  </style>
</head>
<body>

<video class="bg-video" autoplay muted loop>
  <source src="https://res.cloudinary.com/dvtt0ymce/video/upload/v1754228640/Cat_Mushroom_Animated_Digital_Wide_PC_Background_HD_Live_-_Etsy_Video_Video___Anime_wallpaper_Cute_wallpapers_Art_whcjmg.mp4" type="video/mp4">
</video>
<div class="overlay"></div>

<div class="container">
  <div class="sidebar" id="projectList"></div>
  <div class="content">
    <div class="player-bar">
      <div class="vinyl-box">
        <img id="vinyl" class="vinyl" src="" alt="Vinyl" />
      </div>
      <div class="track-info">
        <div id="nowPlaying">Now Playing: -</div>
        <a id="spotifyLink" href="#" class="spotify-btn" target="_blank" style="display: none;">Open in Spotify</a>
      </div>
      <div class="controls">
        <button id="prev">‚èÆ</button>
        <button id="playPause">‚ñ∂Ô∏è</button>
        <button id="next">‚è≠</button>
        <button id="shuffle">üîÄ</button>
        <button id="repeat">üîÅ</button>
      </div>
    </div>
    <audio id="audio" preload="auto"></audio>
  </div>
  <div class="tracklist" id="trackList"></div>
</div>

<script>

let currentProject = 'Pillowcore Radio';
let currentTrackIndex = 0;
let isPlaying = false;
let repeat = false;
let shuffle = false;

const audio = document.getElementById('audio');
const vinyl = document.getElementById('vinyl');
const nowPlaying = document.getElementById('nowPlaying');
const spotifyLink = document.getElementById('spotifyLink');

function loadProjects() {
  const projectList = document.getElementById('projectList');
  projectList.innerHTML = '';
  for (let key in projects) {
    const cover = projects[key].cover;
    const button = document.createElement('div');
    button.className = 'cover-button';
    button.innerHTML = `<img src="${cover}" alt="${key}" onclick="switchProject('${key}')" />`;
    projectList.appendChild(button);
  }
}

function switchProject(projectName) {
  currentProject = projectName;
  renderTracklist();
}

function renderTracklist() {
  const trackList = document.getElementById('trackList');
  trackList.innerHTML = '';
  projects[currentProject].tracks.forEach((track, index) => {
    const btn = document.createElement('button');
    btn.className = 'track-button';
    btn.textContent = track.title;
    btn.onclick = () => playTrack(index);
    if (index === currentTrackIndex && isPlaying) btn.classList.add('active');
    trackList.appendChild(btn);
  });
}

function playTrack(index) {
  currentTrackIndex = index;
  const track = projects[currentProject].tracks[index];
  audio.src = track.url;
  audio.play();
  isPlaying = true;
  updateUI();
}

function updateUI() {
  const track = projects[currentProject].tracks[currentTrackIndex];
  nowPlaying.textContent = `Now Playing: Kozybeats - ${track.title}`;
  vinyl.src = projects[currentProject].cover;
  spotifyLink.href = `https://open.spotify.com/search/${encodeURIComponent("Kozybeats " + track.title)}`;
  spotifyLink.style.display = 'inline-block';
  renderTracklist();
}

document.getElementById('playPause').onclick = () => {
  if (isPlaying) {
    audio.pause();
    isPlaying = false;
    document.getElementById('playPause').textContent = '‚ñ∂Ô∏è';
  } else {
    audio.play();
    isPlaying = true;
    document.getElementById('playPause').textContent = '‚è∏Ô∏è';
  }
};

document.getElementById('next').onclick = () => {
  if (shuffle) {
    playTrack(Math.floor(Math.random() * projects[currentProject].tracks.length));
  } else {
    currentTrackIndex = (currentTrackIndex + 1) % projects[currentProject].tracks.length;
    playTrack(currentTrackIndex);
  }
};

document.getElementById('prev').onclick = () => {
  currentTrackIndex = (currentTrackIndex - 1 + projects[currentProject].tracks.length) % projects[currentProject].tracks.length;
  playTrack(currentTrackIndex);
};

document.getElementById('repeat').onclick = () => {
  repeat = !repeat;
  document.getElementById('repeat').style.color = repeat ? 'lime' : 'white';
};

document.getElementById('shuffle').onclick = () => {
  shuffle = !shuffle;
  document.getElementById('shuffle').style.color = shuffle ? 'lime' : 'white';
};

audio.addEventListener('ended', () => {
  if (repeat) {
    playTrack(currentTrackIndex);
  } else if (shuffle) {
    playTrack(Math.floor(Math.random() * projects[currentProject].tracks.length));
  } else {
    if (currentTrackIndex < projects[currentProject].tracks.length - 1) {
      playTrack(currentTrackIndex + 1);
    }
  }
});

// Initial setup
loadProjects();
renderTracklist();
updateUI();

</script>

</body>
</html>
